---
export interface Props {
        url?: string,
        n? : Int16Array,
        uId? : string,
    }
const {url = null, n=12, uId} = Astro.props;
---
<div class="movie-container" id = {`slider-${uId}`}>
    <button class="handle left-handle">
        <div class="text">
            &#8249;
        </div>
    </button>
    <div class="slider">
        <img src="https://via.placeholder.com/150x250?text=1" alt="">
        <img src="https://via.placeholder.com/150x250?text=2" alt="">
        <img src="https://via.placeholder.com/150x250?text=3" alt="">
        <img src="https://via.placeholder.com/150x250?text=4" alt="">
        <img src="https://via.placeholder.com/150x250?text=5" alt="">
        <img src="https://via.placeholder.com/150x250?text=6" alt="">
        <img src="https://via.placeholder.com/150x250?text=7" alt="">
        <img src="https://via.placeholder.com/150x250?text=8" alt="">
        <img src="https://via.placeholder.com/150x250?text=9" alt="">
        <img src="https://via.placeholder.com/150x250?text=10" alt="">
        <img src="https://via.placeholder.com/150x250?text=11" alt="">
        <img src="https://via.placeholder.com/150x250?text=12" alt="">
        <img src="https://via.placeholder.com/150x250?text=13" alt="">
        <img src="https://via.placeholder.com/150x250?text=14" alt="">
        <img src="https://via.placeholder.com/150x250?text=15" alt="">
        <img src="https://via.placeholder.com/150x250?text=16" alt="">
        <img src="https://via.placeholder.com/150x250?text=17" alt="">
        <img src="https://via.placeholder.com/150x250?text=18" alt="">
    </div>
    <button class="handle right-handle">
        <div class="text">
            &#8250;
        </div>
    </button>
</div>

<style>
    .movie-container {
        display: flex;
        justify-content: center;
        overflow: hidden;
        max-width: 600px;
    }
    .slider {
        --slider-index: 0;
        display: flex;
        max-width: 90%; 
        flex-grow: 1;
        transform: translateX(calc(var(--slider-index) * -100%));
        transition: transform 250ms ease-in-out;
    }
    .slider > img {
        max-width: 25%;
        flex: 0 0 25%;

        }

    .handle {
        border: none;
        width: 2rem;
        background-color: rgb(0, 0, 0, .25);
        z-index: 10;
        border-radius: .5rem;
    }
    .handle:hover{
        background-color: rgb(0, 0, 0, .5);
    }

    .left-handle{
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
    }

    .right-handle{
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
    }
    .movie-container:hover .left-handle::after{
        content: \203A;
    }
    .movie-container:hover .right-handle::after{
        content: \2039;
    }

    .text {
        font-size: 2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        transition: transform 150ms ease-in-out;
    }
    .handle:hover .text {
        transform: scale(1.2);
    }
</style>

<script is:inline defer define:vars={{uId}}>
    const cont = document.getElementById(`slider-${uId}`)
    cont.addEventListener('click', e => {
        let handle
        
        if (e.target.matches('.handle')) {
            handle = e.target
            console.log(handle, uId, 'id')}
        else {
            handle = e.target.closest('.handle')
            console.log(handle, uId, 'id')
        }
        if (handle != null) onHandleClick(handle, uId)
    })



    function onHandleClick(handle, uId) {
        const nSliders = document.getElementsByClassName('movie-container')
        const slider = handle.closest('.movie-container').querySelector('.slider')
        const sliderIndex = parseInt(getComputedStyle(slider).getPropertyValue('--slider-index'))
        if (handle.classList.contains('left-handle') && sliderIndex != 0) {
            slider.style.setProperty('--slider-index', sliderIndex - 1)
        }

        // need to implement max
        if (handle.classList.contains('right-handle')) {
            slider.style.setProperty('--slider-index', sliderIndex + 1)
        }
    }
</script>